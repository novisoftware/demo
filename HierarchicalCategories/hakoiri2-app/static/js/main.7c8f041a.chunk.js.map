{"version":3,"sources":["components/PuzzlePiece.tsx","components/Board.tsx","components/Header.tsx","App.tsx","index.tsx"],"names":["PuzzlePiece","_ref","position","size","label","isActive","onDragStart","onClick","onTouchStart","onTouchMove","onTouchEnd","isVertical","fontSize","width","height","length","_jsx","className","concat","style","gridColumn","x","gridRow","y","display","justifyContent","alignItems","writingMode","border","backgroundColor","color","cursor","draggable","children","initialPieces","id","useEffect","boardElement","document","querySelector","addEventListener","event","preventDefault","passive","removeEventListener","Board","pieces","setPieces","useState","hoverPosition","setHoverPosition","draggedPiece","setDraggedPiece","dragStartPosition","setDragStartPosition","touchStartPosition","setTouchStartPosition","handleTouchMove","touch","touches","deltaX","clientX","deltaY","clientY","newX","Math","floor","newY","correctedX","min","max","correctedY","handleTouchEnd","some","piece","prevPieces","map","_objectSpread","_jsxs","gridTemplateColumns","gridTemplateRows","margin","onDrop","droppedPiece","JSON","parse","dataTransfer","getData","targetX","targetY","isOverlap","isOutOfBounds","BOARD_WIDTH","BOARD_HEIGHT","console","log","onDragOver","X","Y","relativeX","relativeY","rect","currentTarget","getBoundingClientRect","hoverX","hoverY","index","setData","stringify","startX","startY","handleTouchStart","borderRadius","bottom","left","transform","Header","href","App","ReactDOM","render","React","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.7c8f041a.chunk.js","sourcesContent":["import React from 'react';\n\ninterface PuzzlePieceProps {\n    position: { x: number; y: number };\n    size: { width: number; height: number };\n    label: string;\n    isActive: boolean;\n    onDragStart: (event: React.DragEvent<HTMLDivElement>) => void;\n    onClick: () => void;\n    onTouchStart: (event: React.TouchEvent<HTMLDivElement>) => void;\n    onTouchMove: (event: React.TouchEvent<HTMLDivElement>) => void;\n    onTouchEnd: (event: React.TouchEvent<HTMLDivElement>) => void;\n}\n\n\nconst PuzzlePiece: React.FC<PuzzlePieceProps> = ({ position, size, label, isActive, onDragStart, onClick,\n    onTouchStart, onTouchMove, onTouchEnd }) => {\n    let isVertical = false;\n    let fontSize = '1rem';\n    if (size.width === 1 && size.height === 1) {\n        if (label.length == 1) {\n            fontSize = '1.5rem'; // 1文字の場合は大きく\n            isVertical = false; // 1文字の場合は縦書きも横書きもない\n        }\n        else {\n            fontSize = '1.2rem'; // 2文字以上の場合は通常サイズ\n            isVertical = true; // 2文字以上の場合は横書き\n        }\n    } else {\n        if (size.height == size.width) {\n            fontSize = '5rem'; // 大きく\n        } else if (size.height > size.width) {\n            fontSize = '2em'; // 大きく\n            isVertical = true; // 縦長の場合は縦書き\n        }\n        else {\n            fontSize = '2rem'; // 大きく\n            isVertical = false; // 横長の場合は横書き\n        }\n    }\n\n    return (\n        <div\n            className={`puzzle-piece ${isActive ? 'active' : ''}`}\n            style={{\n                gridColumn: `${position.x} / span ${size.width}`,\n                gridRow: `${position.y} / span ${size.height}`,\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                writingMode: isVertical ? 'vertical-rl' : 'horizontal-tb',\n                border: '1.5px solid black',\n                backgroundColor: '#f0f0f0',\n                color: '#000', // 文字色を黒に変更\n                fontSize: fontSize, // 文字サイズを調整\n                cursor: 'grab',\n                width: '100%', // グリッド内で幅を100%に設定\n                height: '100%', // グリッド内で高さを100%に設定\n            }}\n            draggable=\"true\"\n            onDragStart={onDragStart}\n            onClick={onClick}\n            onTouchStart={onTouchStart}\n            onTouchMove={onTouchMove}\n            onTouchEnd={onTouchEnd}\n        >\n            {label}\n        </div>\n    );\n};\n\nexport default PuzzlePiece;","import React, { useEffect, useState } from 'react';\nimport PuzzlePiece from './PuzzlePiece';\n\ninterface PieceData {\n    id: number;\n    label: string;\n    size: {\n        width: number;\n        height: number;\n    };\n    position: {\n        x: number;\n        y: number;\n    };\n}\n\ninterface Position {\n    x: number;\n    y: number;\n}\n\nconst BOARD_WIDTH = 6; // グリッドの列数\nconst BOARD_HEIGHT = 5; // グリッドの行数\n\nconst initialPieces: PieceData[] = [\n    { id: 1, label: \"父\", size: { width: 1, height: 2 }, position: { x: 3, y: 1 } },\n    { id: 2, label: \"娘\", size: { width: 2, height: 2 }, position: { x: 4, y: 1 } },\n    { id: 3, label: \"母\", size: { width: 1, height: 2 }, position: { x: 6, y: 1 } },\n    { id: 4, label: \"丁稚\", size: { width: 1, height: 1 }, position: { x: 1, y: 3 } },\n    { id: 5, label: \"手代\", size: { width: 1, height: 1 }, position: { x: 2, y: 3 } },\n    { id: 6, label: \"大番頭\", size: { width: 4, height: 1 }, position: { x: 3, y: 3 } },\n    { id: 7, label: \"丁稚\", size: { width: 1, height: 1 }, position: { x: 1, y: 4 } },\n    { id: 8, label: \"番頭\", size: { width: 2, height: 1 }, position: { x: 2, y: 4 } },\n    { id: 9, label: \"女中\", size: { width: 2, height: 1 }, position: { x: 4, y: 4 } },\n    { id: 10, label: \"兄嫁\", size: { width: 1, height: 1 }, position: { x: 6, y: 4 } },\n    { id: 11, label: \"番犬\", size: { width: 1, height: 1 }, position: { x: 1, y: 5 } },\n    { id: 12, label: \"祖父\", size: { width: 2, height: 1 }, position: { x: 2, y: 5 } },\n    { id: 13, label: \"祖母\", size: { width: 2, height: 1 }, position: { x: 4, y: 5 } },\n    { id: 14, label: \"丁稚\", size: { width: 1, height: 1 }, position: { x: 6, y: 5 } },\n];\n\nconst Board: React.FC = () => {\n    const [pieces, setPieces] = useState<PieceData[]>(initialPieces);\n    const [hoverPosition, setHoverPosition] = useState<{ x: number; y: number } | null>(null);\n    const [draggedPiece, setDraggedPiece] = useState<PieceData | null>(null); // ドラッグ中のピースを保存\n    const [dragStartPosition, setDragStartPosition] = useState<{ x: number; y: number } | null>(null); // ドラッグ開始位置を保存\n    const [touchStartPosition, setTouchStartPosition] = useState<{ x: number; y: number } | null>(null);\n\n    const handleTouchStart = (event: React.TouchEvent<HTMLDivElement>, piece: PieceData) => {\n        event.preventDefault();\n        const touch = event.touches[0];\n        setDraggedPiece(piece);\n        setTouchStartPosition({ x: touch.clientX, y: touch.clientY });\n    };\n\n    const handleTouchMove = (event: React.TouchEvent<HTMLDivElement>) => {\n        event.preventDefault();\n        if (!draggedPiece || !touchStartPosition) return;\n\n        const touch = event.touches[0];\n        const deltaX = touch.clientX - touchStartPosition.x;\n        const deltaY = touch.clientY - touchStartPosition.y;\n\n        const newX = Math.floor(draggedPiece.position.x + deltaX / (600 / BOARD_WIDTH));\n        const newY = Math.floor(draggedPiece.position.y + deltaY / (500 / BOARD_HEIGHT));\n\n        // 枠外に出ないよう補正\n        const correctedX = Math.min(Math.max(newX, 1), BOARD_WIDTH - draggedPiece.size.width + 1);\n        const correctedY = Math.min(Math.max(newY, 1), BOARD_HEIGHT - draggedPiece.size.height + 1);\n\n        setHoverPosition({ x: correctedX, y: correctedY });\n\n        // setDraggedPiece({ ...draggedPiece, position: { x: correctedX, y: correctedY } });\n    };\n\n    const handleTouchEnd = (event: React.TouchEvent<HTMLDivElement>) => {\n        event.preventDefault();\n        if (!draggedPiece || !hoverPosition) return;\n\n        // 他のピースと重なるか確認\n        const isOverlap = pieces.some((piece) => {\n            return (\n                piece.id !== draggedPiece.id && // ドロップされたピース自身は除外\n                hoverPosition.x < piece.position.x + piece.size.width &&\n                hoverPosition.x + draggedPiece.size.width > piece.position.x &&\n                hoverPosition.y < piece.position.y + piece.size.height &&\n                hoverPosition.y + draggedPiece.size.height > piece.position.y\n            );\n        });\n\n        if (!isOverlap) {\n            setPieces((prevPieces) =>\n                prevPieces.map((piece) =>\n                    piece.id === draggedPiece.id ? { ...draggedPiece, position: { x: hoverPosition.x, y: hoverPosition.y } } : piece\n                )\n            );\n        }\n        setDraggedPiece(null);\n        setTouchStartPosition(null);\n    };\n\n\n    const handleDragOver = (event: React.DragEvent<HTMLDivElement>) => {\n        event.preventDefault();\n        if (!draggedPiece) return; // ドラッグ中のピースが存在しない場合は処理を中断\n        if (!dragStartPosition) return; // ドラッグ開始位置が未設定の場合は処理を中断\n        // ドラッグ開始位置を基準に相対的な位置を計算\n        const X = event.clientX; // X座標\n        const Y = event.clientY; // Y座標\n        const relativeX = X - dragStartPosition.x; // ドラッグ操作での相対的なX座標\n        const relativeY = Y - dragStartPosition.y; // ドラッグ操作での相対的なY座標\n\n        // ドラッグ中のピースの位置を基準にホバー位置を計算\n        // グリッドの位置を計算\n        const rect = event.currentTarget.getBoundingClientRect();\n        let hoverX = Math.floor(relativeX / (1.0 * rect.width / BOARD_WIDTH) + 0.5) + draggedPiece.position.x; // グリッドの列を計算\n        let hoverY = Math.floor(relativeY / (1.0 * rect.height / BOARD_HEIGHT) + 0.5) + draggedPiece.position.y; // グリッドの行を計算\n\n        // ドロップ位置を補正\n        hoverX = Math.max(hoverX, 1); // 最小値を1に設定\n        hoverY = Math.max(hoverY, 1); // 最小値を1に設定\n        hoverX = Math.min(Math.max(hoverX, 1), BOARD_WIDTH - draggedPiece.size.width + 1);\n        hoverY = Math.min(Math.max(hoverY, 1), BOARD_HEIGHT - draggedPiece.size.height + 1);\n\n        setHoverPosition({ x: hoverX, y: hoverY });\n    };\n\n    const handleDrop = (event: React.DragEvent<HTMLDivElement>) => {\n        event.preventDefault();\n        const droppedPiece = JSON.parse(event.dataTransfer.getData('text/plain')); // as PieceData;\n        const targetX = hoverPosition?.x || 1;\n        const targetY = hoverPosition?.y || 1;\n\n        // 他のピースと重なるか確認\n        const isOverlap = pieces.some((piece) => {\n            return (\n                piece.id !== droppedPiece.id && // ドロップされたピース自身は除外\n                targetX < piece.position.x + piece.size.width &&\n                targetX + droppedPiece.size.width > piece.position.x &&\n                targetY < piece.position.y + piece.size.height &&\n                targetY + droppedPiece.size.height > piece.position.y\n            );\n        });\n\n        // 枠の外に出ないか確認\n        const isOutOfBounds = targetX < 1 || targetY < 1 || targetX + droppedPiece.size.width > BOARD_WIDTH + 1 || targetY + droppedPiece.size.height > BOARD_HEIGHT + 1;\n\n        if (!isOverlap && !isOutOfBounds) {\n            setPieces((prevPieces) =>\n                prevPieces.map((piece) =>\n                    piece.id === droppedPiece.id\n                        ? { ...piece, position: { x: targetX, y: targetY } }\n                        : piece\n                )\n            );\n        } else {\n            console.log(\"重なりが発生しました。ドラッグをキャンセルします。\");\n        }\n\n        setHoverPosition(null); // ドロップ後にホバー位置をリセット\n        setDraggedPiece(null); // ドロップ後にドラッグ中のピースをリセット\n    };\n\n    return (\n        <div\n            style={{\n                position: 'relative',\n                width: '610px', // ボードの幅 + 枠の幅\n                height: '540px', // ボードの高さ + 枠の幅\n                border: '10px solid black', // 枠を追加\n                backgroundColor: '#fff',\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n            }}\n        >\n            <div\n                className=\"board\"\n\n                style={{\n                    display: 'grid',\n                    gridTemplateColumns: 'repeat(6, 1fr)',\n                    gridTemplateRows: 'repeat(5, 1fr)',\n                    width: '600px', // ボードの幅\n                    height: '500px', // ボードの高さ\n                    position: 'relative',\n                    backgroundColor: '#fff0',\n                    margin: '5px', // 枠の幅を考慮してマージンを追加\n                }}\n                onDrop={handleDrop}\n                onDragOver={handleDragOver}\n            >\n                {pieces.map((piece, index) => (\n                    <PuzzlePiece\n                        key={index}\n                        label={piece.label}\n                        size={piece.size}\n                        position={piece.position}\n                        isActive={false}\n                        onClick={() => console.log(`${piece.label} clicked`)}\n                        onDragStart={(event) => {\n                            event.dataTransfer.setData('text/plain', JSON.stringify(piece));\n                            setDraggedPiece(piece); // ドラッグ中のピースを保存\n\n                            const startX = event.clientX; // 操作開始時のX座標\n                            const startY = event.clientY; // 操作開始時のY座標\n                            console.log(`Drag started at X: ${startX}, Y: ${startY}`); // ログ出力\n                            setDragStartPosition({ x: startX, y: startY }); // ドラッグ開始位置を保存\n                        }}\n                        onTouchStart={(event) => handleTouchStart(event, piece)}\n                        onTouchMove={handleTouchMove}\n                        onTouchEnd={handleTouchEnd}\n                    />\n                ))}\n                {hoverPosition && draggedPiece && (\n                    <div\n                        style={{\n                            gridColumn: `${hoverPosition.x} / span ${draggedPiece.size.width}`,\n                            gridRow: `${hoverPosition.y} / span ${draggedPiece.size.height}`,\n                            backgroundColor: 'rgba(128, 128, 255, 0.1)',\n                            border: '1px solid rgba(128, 128, 255, 0.5)',\n                            borderRadius: '7px',\n                            position: 'absolute',\n                            width: '100%',\n                            height: '100%',\n                        }}\n                    />\n                )}\n            </div>\n            {/* 下辺中央の出口を表現する切れ目 */}\n            <div\n                style={{\n                    position: 'absolute',\n                    bottom: '-10px',\n                    left: '50%',\n                    transform: 'translateX(-50%)',\n                    width: '200px', // 2マス分の幅\n                    height: '10px', // 枠の高さ\n                    backgroundColor: '#fff', // 枠の切れ目を白で表現\n                }}\n            />\n        </div>\n    );\n};\n\nuseEffect(() => {\n    const boardElement = document.querySelector('.board');\n    if (boardElement) {\n        boardElement.addEventListener('touchmove', (event) => event.preventDefault(), { passive: false });\n    }\n    return () => {\n        if (boardElement) {\n            boardElement.removeEventListener('touchmove', (event) => event.preventDefault());\n        }\n    };\n}, []);\n\nexport default Board;","import React from 'react';\n\nconst Header: React.FC = () => {\n    return (\n        <header>\n            <h1>箱入り娘</h1>\n            <p>箱入り娘を外に出そう。詳しくはWikipediaの<a href=\"https://ja.wikipedia.org/wiki/%E7%AE%B1%E5%85%A5%E3%82%8A%E5%A8%98_(%E3%83%91%E3%82%BA%E3%83%AB)\">箱入り娘</a>を見よう。</p>\n        </header>\n    );\n};\n\nexport default Header;","import React from 'react';\nimport Board from './components/Board';\nimport Header from './components/Header';\nimport './styles/App.css';\n\nconst App: React.FC = () => {\n    return (\n        <div className=\"App\">\n            <Header />\n            <Board />\n        </div>\n    );\n};\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './styles/App.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}